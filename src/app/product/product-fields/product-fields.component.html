<p-dialog [(visible)]="displayDialog" [modal]="true" width="600">
  <app-create-category hideCancelBtn="true" (notify)="onNotify($event)"></app-create-category>
</p-dialog>

<form *ngIf="product && productForm" [formGroup]="productForm">
  <div class="row">
    <div class="form-group col-sm-6">
      <label class="form-control-label">Nome</label>&nbsp;<i style="color: red">*</i>
      <input type="text" class="form-control" [ngClass]="{'is-invalid':
              productForm.get('name').invalid && productForm.get('name').dirty}"
             [(ngModel)]="product.name" name="name" formControlName="name">
      <app-validation-message [control]="productForm.get('name')" message="Nome é obrigatório"
                              errorType="required">
      </app-validation-message>
      <app-validation-message [control]="productForm.get('name')" message="Nome deve ter no mínimo 5 caracteres"
                              errorType="minlength">
      </app-validation-message>
      <app-validation-message [control]="productForm.get('name')" message="Nome deve ter no máximo 50 caracteres"
                              errorType="maxlength">
      </app-validation-message>
    </div>
    <div class="form-group col-sm-6">
      <label>Foto</label>
      <input *ngIf="product.photo === null || product.photo === undefined" formControlName="photo"
        type="file" accept="image/*" (change)="onChangeImage($event)" class="form-control-file">
      <p style="font-size: 8px">Tamanho máximo: 1MB</p>
      <div *ngIf="product.photo" class="row">
        <div class="col-lg-8">
            <img class="form-control-file"
                 src="data:image/jpg;base64,{{product.photo}}" class="img-thumbnail">
        </div>
        <div class="col-sm-4">
          <button class="btn btn-default" (click)="product.photo = null;">
            <i class="fa fa-refresh"></i>&nbsp;Alterar
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-2 col-lg-2 form-group">
      <label>Preço</label>&nbsp;<i style="color: red">*</i>
      <input type="text" currencyMask
             [options]="{ prefix: 'R$ ', thousands: '.', decimal: ',', allowNegative: false }"
             class="form-control" formControlName="price" [(ngModel)]="product.price" name="price">
      <app-validation-message [control]="productForm.get('price')"
        message="Preço é Obrigatório" errorType="required"></app-validation-message>
    </div>
    <div class="col-sm-2 col-lg-2 form-group">
      <label>Altura</label>
      <input type="number" class="form-control" [(ngModel)]="product.height"
        name="height" formControlName="height">
    </div>
    <div class="col-sm-2 col-lg-2 form-group">
      <label>Largura</label>
      <input type="number" class="form-control" [(ngModel)]="product.width" formControlName="width" name="width">
    </div>
    <div class="col-sm-2 col-lg-2 form-group">
      <label>Diâmetro</label>
      <input type="number" class="form-control" [(ngModel)]="product.diameter" formControlName="diameter"
             name="diameter">
    </div>
    <div class="col-sm-2 col-lg-2 form-group">
      <label>Peso</label>
      <input type="number" class="form-control" [(ngModel)]="product.weight" formControlName="weight"
             name="weight">
    </div>
  </div>
  <div class="row">
    <div class="col-6 form-group">
      <p-multiSelect [options]="categories" [(ngModel)]="product.categories" name="categories"
                     [defaultLabel]="'Selecione'" [style]="{width: '100%'}"
                     displaySelectedLabel="true" showToggleAll="true"
                     placeholder="Selecione" formControlName="categories">
      </p-multiSelect>
      Categorias:
      <span (click)="removeCategory(category)" style="margin-right: 5px;"
            *ngFor="let category of product.categories" class="badge badge-primary">
        {{category.name}}&nbsp;<i class="fa fa-times"></i>&nbsp;
      </span>
    </div>
    <div class="col-2">
      <button class="btn btn-primary" (click)="displayDialog = true">
        <i class="fa fa-plus"></i>&nbsp;Nova Categoria
      </button>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-12 form-group">
      <label>Descrição</label>
      <textarea cols="30" rows="10" class="form-control" formControlName="description"
        [(ngModel)]="product.description" name="description"></textarea>
    </div>
  </div>
</form>
